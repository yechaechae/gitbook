
픽업 위치, 타임스탬프 데이터만 사용

여행시간 예측은 회귀
y는 여행시간을 나타내고 x는 features(독립변수)
엡실론은 에러 f는 y와 x의 관계를 나타내는 알수없는 회귀

SVM, k-nearest neighbors, nn, deep learning으로 예측한 논문 존재
저자는 트리에 집중, 특히 Random forest, Extra Trees를 포함하는 CART 와 bagged or boosted 앙상블, 
최근 Xgboost와 LightGBM알고리즘으로 제안된 random forest, extra trees
이 과정은 train하기 쉽고 딥러닝에 비하면 적은 부담을 준다.

CART regression tree

ensemble fo B = 3 



Learning to Estimate the Travel Time

여행시간을 예측하는 시스템은 이미 많이 알려져 있다. 
존재하는 솔루션은 두가지 카테고리로 나뉘어진다.
1. route-base solution, 직관적인 물리적인 모델로 : 주어진 경로의 전체 여행 시간은 각 도로를 통과하는 이동 시간의 합계로 공식화 segment1 그리고 각 교차로에서의 지연 시간.
2. data-driven solution, machine learning

저자는 존재하는 메소드의 drawback문제를 극복하는 머신러닝모델 제안
위치 기반의 효과적인 데이터 , floating-car data, road network data, uservehavior information -> 과거데이터기반, 실시간
wide linear model, depp neural network, recurrent neural network의 이점들을 혼합

기여점
* ETA 문제를 regression 문제로 공식화 함
* 기존의 방법을 능가하는 ETA 문제를 해결하는데 새로운 딥러닝모델 제시
* 위치기반데이터를 위한 잘 설계된 feature 시스템을 구축함
* 제안한 알고리즘을 큰 스케일의 과거데이터와 온라인 실시간 쿼리로 평가함. 제안된 솔루션의 모든 결과는 최신의 솔루션을 능가함.



feature를 몇가지 타입으로 요약
Spatial Information: 여행시간은 지리적인 위치와 경로와 높은 연관성이 있다. 지리데이터
Temporal Information : 여행 출발시간도 여행시간 예측에 영향을 준다. 시간 
Traffic Information : 실시간 교통정보 
Personalized Information : 운전자 개인 정보
Augmented Information : 그 외에 사용할 수 있는 모든 정보 ex. 날씨, 교통 법규 등 

GBDT(Gradient boosting decision tree), FM(factorization machines)은 ETA learning 문제를 해결하는데 가장 좋은 알고리즘은 아니다.
GBDT는 큰 feature 셋에 적용하기 어렵다. FM 성능은 feature에 의존적이고 모델 표현에 제한적이다.

Wide & Deep Learning
모델은 두 블락 구조를 가진다. wide, Deep

wide 모델은 logistic regression과 같이 기존의 추천 알고리즘과 같은 generalized linear model이라고 설명될 수 있다.
deep model과 비교하면 wide 모델은 shallow(얕은) 모델이라고 여겨진다.

deep 모델은 sparse input feature를 dense feature로 변환한다. feature embedding layer를 사용해서 
dense input feature는 임베디드 된 피쳐와 feed를 multiple layer perceptron(MLP)로 알려진 feed-forward neural network(FNN)로 이어준다? 

가장 위의 계층인 regressor는 마지막 예측을 제공하기 위해서 wide와 deep 모델에서 나온 아웃풋을 합친다.
보통 sparse feature는 categorical 정보를 나타내고 dense feature는 numerical 정보를 나타낸다. ex) driver-id는 sparse feature이고 반면에 경로 길이는 dense feature이다.

LSTM은 recurrent neural network(RNN)이다. sequential 데이터로 훈련할 때 성공적이었다. 
LSTM은 각각의 각 세그먼트의 로컬 정보와 시퀀스에 따른 장기 종속성(long-term dependency)를 모두 캡처 할 수 있습니다.
**road segment sequence 문제를 모델링 하기 위해서 사용**

LSTM은 RNN의 gradient vanishing 과 exploding문제를 감소시킨다.  추가적인 메모리 셀을 이용해서 

Wide-Deep-Recurrent Learning : 
여행시간을 예측하는 딥러닝 모델을 학습시키기 위해서 wide, deep, recurrent 모델을 함께 사용 

wide 모델은 Wide&Deep Network의 wide모델과 비슷하다. 
deep 모델은 
recurrent 모델은 표준 RNN의 변형
back propagation MAPE loss
세 가지 모듈을 합쳤기 때문에 적절한 글로벌 러닝 레이트를 찾기 어렵다.
러닝 레이트를 0.001로 두었다. 


적은 피쳐셋으로는 딥러닝의 이점을 이용하기 어렵다. 게다가 이러한 솔루션들은 타임시리즈 예측에서 자주 문제되는 멀티플 스텝 예측 상황에서 제대로 작동하지 않는다.
아마도 WDR러닝 모델이 여행시간 예측 문제에 처음으로 딥러닝 모델로 디자인되었다.
road trajectory 마이닝문제는 NLP
각 route는 sentence로 여겨짐 각 road segment에 상응하는 상호작용은 단어로 여겨진다.

WDR네트워크는 여행의 전반적인 통계속성을 wide and deep 모델로, sequential road segments의 상세한 특성은 recurrent모델로 변환 했다.

Route-ETA, TEMP, PTTE 모델과 비교.

MAPE, MAE, MSE 를 측정, 비교하는데 사용

### CONCLUSION
기존 방법의 약점을 극복하고 위치기반 시스템의 효과적인 feature 시스템을 정립함, 각 경로를 높은 차원의 피쳐 벡터로 표현
ETA 문제를 순수 regression 모델로 공식화 했다.  몇가지의 존재하는 regression 모델로 문제를 해결하고 새로운 딥러닝 모델을 만들어 문제를 해결했다. 제안한 알고리즘을 큰 스케일의 과거데이터와 온라인 실시간 쿼리로 평가함. 제안된 솔루션의 모든 결과는 최신의 솔루션을 능가함. 이 모델은 일반적인 regression 문제에 적용 될 수있다.







